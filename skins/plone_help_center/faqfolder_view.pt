<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
    lang="en"
    metal:use-macro="here/main_template/macros/master"
    i18n:domain="plonehelpcenter">

<body>
    <div metal:fill-slot="main">
        <div metal:define-macro="body" 
             tal:define="req_section request/section|nothing; 
                         faqpath python: '/'.join(here.getPhysicalPath()); 
                         pss python:modules['Products.PythonScripts.standard']; 
                         full request/full|nothing">

            <p style="discreet" tal:condition="python: req_section or not full">[ <a tal:attributes="href python:'%s?full=1' % here.absolute_url()"> View entire FAQ in full </a>]</p>
            <p style="discreet" tal:condition="python: full and not req_section">[ <a tal:attributes="href python:'%s' % here.absolute_url()">View table of contents</a> ]</p>
            <div tal:condition="request/form/section |nothing">
                <a href=""
                    class="link-parent"
                    tal:define="parent_url here/absolute_url"
                    tal:condition="python: req_section"
                    tal:attributes="href parent_url"
                    i18n:translate="go_to_parent_url">
                    Up one level
                </a>
            </div>

            <p tal:content="here/description">Folder Content Description</p>


            <div tal:define="sections python:test(req_section,[req_section],here.sections)" tal:repeat="section sections">
                <h2 tal:content="section"></h2>
                <p style="discreet" tal:condition="python: not full and not req_section">[ <a tal:attributes="href python:'%s?full=1&section=%s' % ( here.absolute_url(), pss.url_quote(section) )">View section in full</a> ]</p>

                <ul tal:condition="not: full">
                    <li tal:repeat="entry python: here.portal_catalog(portal_type='HelpCenterFAQ', getSections=section, path=faqpath)">
                    <a href="" tal:content="entry/Title"
                        tal:attributes="href entry/getURL">FAQ Question</a>
                    </li>
                </ul>
                <div tal:condition="full" tal:repeat="entry python: here.portal_catalog(portal_type='HelpCenterFAQ', getSections=section, path=faqpath)">
                    <h3 tal:content="entry/Title"></h3>
                    <tal:question define="entry entry/getObject">
                    <div style="font-weight: bold; font-style: italic" tal:content="structure entry/getQuestion" tal:condition="python: entry.getQuestion() != entry.Title()"></div>
                    <div tal:content="structure entry/getAnswer"></div>
                    </tal:question>
                </div>
            </div>

        </div>
    </div>
</body>

</html>
