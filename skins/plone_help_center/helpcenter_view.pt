<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone">
      
<head>
    <metal:css fill-slot="css_slot">
    <style type="text/css" media="all"
           tal:content="string: @import url($portal_url/helpcenter.css);"></style>
    </metal:css>

    <metal:override fill-slot="column_two_slot" />

</head>
<body>

<metal:main fill-slot="main">
    <tal:main-macro metal:define-macro="main"
                    tal:define="my_path python: '/'.join(here.getPhysicalPath());
                    subtypes_tuples python:(
                                     ('HelpCenterFAQFolder','HelpCenterFAQ'),
                                     ('HelpCenterHowToFolder','HelpCenterHowTo'),
                                     ('HelpCenterTutorialFolder','HelpCenterTutorial'),
                                     ('HelpCenterLinkFolder','HelpCenterLink'),
                                     ('HelpCenterErrorReferenceFolder','HelpCenterErrorReference'),
                                     ('HelpCenterGlossary','HelpCenterDefinition'));
                    subtypes python: [ t[0] for t in subtypes_tuples ]">
            <h1 tal:content="here/title_or_id" class="documentFirstHeading">
              Title or id
            </h1>
        
            <div metal:use-macro="here/document_actions/macros/document_actions">
                Document actions (print, sendto etc)
            </div>
        
            <form name="searchform"
                  action="http://search.plone.org/search">
                   
                <fieldset style="float: right;">
                    
                    <legend>Documentation search</legend>
                    
                    <label for="searchGadget" class="hiddenStructure" i18n:translate="text_search">Search</label>
                    <input name="SearchableText"
                           type="text"
                           size="20"
                           value=""
                           alt="Search"
                           title="Search"
                           style="margin-bottom: 0.5em;"
                           accesskey="accesskeys-search"
                           i18n:attributes="alt accesskey title"
                           tal:attributes="value request/SearchableText|nothing;
                                           tabindex tabindex/next" 
                    />
    
                    <input class="searchButton"
                           type="submit"
                           value="Search"
                           accesskey="accesskeys-search"
                           tal:attributes="tabindex tabindex/next"
                           i18n:attributes="value accesskey" />
                           
                    <br />
                    
                    in
                    
                    <!-- XXX FIXME: This doesn't do anything useful yet -->
                    <select name="path"
                            tal:define="path request/form/path|nothing;">
                      <option value="/plone.org"
                              tal:attributes="selected python:test(path=='/plone.org', 'selected', nothing)">All documentation</option>
                      <option value="/plone.org/documentation"
                              tal:attributes="selected python:test(path=='/plone.org/documentation', 'selected', nothing)">FAQs</option>
                      <option value="/plone.org/development"
                              tal:attributes="selected python:test(path=='/plone.org/development', 'selected', nothing)">How-tos</option>
                      <option tal:condition="python: here.aq_parent != portal_object" 
                              tal:attributes="value python:'/'.join(here.aq_parent.getPhysicalPath())">Tutorials</option>
                    </select>
                </fieldset>
            </form>

            <div class="documentDescription"
                 tal:content="here/Description">
                description
            </div>
        
            <p>
            <img tal:attributes="src string:$portal_url/rss.gif" />
            <a tal:attributes="href python:portal_url + '/search_rss?sort_on=modified&sort_order=descending&path=' + my_path + '&' + ('&'.join(['portal_type=%s' % s for s in subtypes ]))" title="RSS feed for all documentation types">
                RSS feed for all documentation types
            </a>
            </p>

            <p>
            <img tal:attributes="src string:$portal_url/helpcenter_icon.gif" />
            <a href="helpcenter_help">
                Instructions on how to contribute to and use this resource
            </a>
            </p>

            <div class="visualClear"></div>
            
            <tal:defs define="help_types python: here.portal_catalog(portal_type=subtypes, path=my_path)">
              <tal:listings repeat="help_type_tuple subtypes_tuples">
                <div tal:define="help_type python:[ c for c in help_types if c.portal_type==help_type_tuple[0] ][0]" tal:condition="help_type">
                  <div tal:define="folder_path python: '/'.join(help_type.getObject().getPhysicalPath()); objs python:here.portal_catalog(portal_type=help_type_tuple[1], path=folder_path)">

                    <div class="portlet portletThirdWidth">
                        <h6>
                        <a tal:attributes="href help_type/getURL;
                                           title help_type/Description|nothing;">
                        Latest <span tal:replace="help_type/Title">[type]</span>
                        </a>
                        </h6>

                        <div class="portletBody">
                            
                            <tal:list condition="objs">
                            <div class="portletContent"
                                 tal:repeat="obj objs">
                                 
                                <img src="" alt="" 
                                     tal:attributes="src obj/getIcon"
                                      />
                                <a href="#" 
                                   tal:attributes="href obj/getURL" 
                                   tal:content="obj/Title">title</a>
                            </div>
                            </tal:list>
                        
                            <div class="portletContent odd">
                                <a class="portletMore"
                                   tal:attributes="href help_type/getURL" 
                                   tal:content="structure string: More ${help_type/Title}&#8230;"
                                   >More FAQs</a>
                            </div>
                          </div>
                        </div>

                    </div>
                </div>
                        <div class="visualClear" tal:condition="python: repeat['help_type_tuple'].number() % 3 == 0" />
            </tal:listings>
            <tal:nolist tal:condition="python: not help_types and not here.contentValues(subtypes)">
              <!-- or at least none that this person has the rights to see -->
              <p class="discreet">There are no contained help center object types.</p>
            </tal:nolist>
            <tal:nopublished tal:condition="python: not help_types and here.contentValues(subtypes)">
              <!--- this user has perms to see the contained types, except that particular state(s) are required -->
              <p class="discreet">There are contained help center object types, but none will are viewable because of their state.</p>
            </tal:nopublished>
            </tal:defs>

        <div class="visualClear"></div>
      
        </tal:main-macro>
    </metal:main>

  </body>
</html>
