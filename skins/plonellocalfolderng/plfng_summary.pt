<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      i18n:domain="plone"
      metal:use-macro="here/main_template/macros/master">

<body>


  <div metal:fill-slot="main"
     tal:define="show python:request.get('show','none');
                 folderfilter python:request.get('folderfilter', '');
                 global decodedFilter python:here.decodeFolderFilter(folderfilter);
                 global filterValues decodedFilter;
                 global filter decodedFilter;
                 standalone python:1;
                 folder_props  python:here.getProperties(REQUEST=request);
                 total_vis_size    python:folder_props.get('size',0);
                 total_vis_folders python:folder_props.get('folders',0);
                 total_vis_files   python:folder_props.get('files',0);
                 filteredOutFolderContents python:here.getFilteredOutContents();
                 filteredFolderContents python:here.getFilteredContents();
                 legalFiles python:test(show.find('LegalContent') >= 0,
                                        filteredFolderContents,[]);
                 illegalFiles python:filteredOutFolderContents[0];
                 total_illegal_files python:len(illegalFiles);
                 illegalFolders python:filteredOutFolderContents[1];
                 total_illegal_folders python:len(illegalFolders);
                 hiddenFiles python:test(show.find('HiddenContent') >= 0,
                                         filteredOutFolderContents[2],[]);
                 total_hidden_files python:len(hiddenFiles);
                 hiddenFolders python:test(show.find('HiddenContent') >= 0,
                                           filteredOutFolderContents[3],[]);
                 total_hidden_folders python:len(hiddenFolders);
                 mtool mtool|here/portal_membership;
                 myfolder python:here.absolute_url()==mtool.getHomeUrl();
                 hiddenFilePrefixes here/hidden_file_prefixes;
                 hiddenFileSuffixes here/hidden_file_suffixes;
                 hiddenFileNames here/hidden_file_names;
                 hiddenFolderNames here/hidden_folder_names;
                 hiddenFolderSuffixes here/hidden_folder_suffixes;
                 hiddenFolderNames here/hidden_folder_names;
                 total_files python:total_vis_files+total_hidden_files+total_illegal_files;
                 total_folders python:total_vis_folders+total_hidden_folders+total_illegal_folders;">

     <div>
        <br>
        <b>total # files = </b>
        <span tal:content="total_files">
          files
        </span>
        (<span tal:content="total_vis_files">
          files
        </span> visible
        
        ,
        <span tal:content="total_hidden_files">
          files
        </span> hidden
        ,
        <span tal:content="total_illegal_files">
          files
        </span> illegal
        )
        <br><br>

        <b>total # subfolders = </b>
        <span tal:content="total_folders">
          files
        </span>
        (<span tal:content="total_vis_folders">
          files
        </span> visible
        
        ,
        <span tal:content="total_hidden_folders">
          files
        </span> hidden
        ,
        <span tal:content="total_illegal_folders">
          files
        </span> illegal
        )
        <br><br>
        
        <fieldset>
        <legend>Visible Content:</legend>
        <b>total # bytes used by visible content = </b>
        
        <span tal:content="total_vis_size">
          size
        </span>
        <br>
        </fieldset>

        <fieldset>
        <legend>Content with Illegal Plone ID's:</legend>
        
        per OFS/OBjectManager.py, Plone object ID's :: <br>
        <ul>
        <li>can ONLY have the characters: [a-zA-Z0-9-_~,.$\(\)# ]</li>
        <li>cannot start with '_' or 'aq_'</li>
        <li>cannot end with '__'</li>
        <li>cannot be '.', '..', '/', or the reserved word 'REQUEST'</li>
        </ul>

        <br>
        <b>files with illegal Plone ID's</b><br>
        
        <metal:block tal:condition="not: illegalFiles">
        <p> none</p> 
        </metal:block>
        <metal:block tal:condition="illegalFiles">
         <br>
         <table id="sortable1"
             class="listing"
             summary="Content listing"
             cellpadding="0" cellspacing="0">
             <thead>
                <tr>
                   <th>Title</th>
                </tr>
             </thead>
           <tbody>
	           <metal:block tal:repeat="item illegalFiles">
                  <tr>
                    <td i18n:translate="" tal:content="python:item">
                      itemName
                    </td>
                  </tr>
              </metal:block>
             </tbody>
           </table>
        </metal:block>
        
        <br>
        <b>subfolders with illegal Plone ID's</b><br>
        <metal:block tal:condition="not: illegalFolders">
        <p> none</p> 
        </metal:block>
        <metal:block tal:condition="illegalFolders">
         <br>
         <table id="sortable2"
             class="listing"
             summary="Content listing"
             cellpadding="0" cellspacing="0">
             <thead>
                <tr>
                   <th>Title</th>
                </tr>
             </thead>
           <tbody>
	           <metal:block tal:repeat="item illegalFolders">
                  <tr>
                    <td i18n:translate="" tal:content="python:item">
                      itemName
                    </td>
                  </tr>
              </metal:block>
             </tbody>
           </table>
        </metal:block>
        </fieldset>

        <fieldset tal:condition="python:show.find('HiddenContent') >= 0">
        <legend>Hidden Content:</legend>
        
	         <fieldset>
		        <legend>Hidden Folders:</legend>
	        <b>Exact Folder Name Filters = </b>
	        <span tal:content="hiddenFolderNames">
	          hiddenFileNames
	        </span>
	        <br>
	        <b>Folder Name Suffix Filters = </b>
	        <span tal:content="hiddenFolderSuffixes">
	          hiddenFileSuffixes
	        </span>
	        <br>
	        <metal:block tal:condition="not: hiddenFolders">
	        <p> none</p> 
	        </metal:block>
	        <metal:block tal:condition="hiddenFolders">
	         <table id="sortable3"
	             class="listing"
	             summary="Content listing"
	             cellpadding="0" cellspacing="0">
	             <thead>
	                <tr>
	                   <th>Title</th>
	                </tr>
	             </thead>
	           <tbody>
		           <metal:block tal:repeat="item hiddenFolders">
	                  <tr>
	                    <td i18n:translate="" tal:content="python:item">
	                      itemName
	                    </td>
	                  </tr>
	              </metal:block>
	             </tbody>
	           </table>
	          </metal:block>
	        </fieldset>
	        
	        <fieldset>
	        <legend>Hidden Files:</legend>
	        
	        <b>Exact File Name Filters = </b>
	        <span tal:content="hiddenFileNames">
	          hiddenFileNames
	        </span>
	        <br>
	        <b>File Name Prefix Filters =</b>
	        <span tal:content="hiddenFilePrefixes">
	          hiddenFilePrefixes
	        </span>
	        <br>
	        <b>File Name Suffix Filters = </b>
	        <span tal:content="hiddenFileSuffixes">
	          hiddenFileSuffixes
	        </span>
	        <br>
	        <metal:block tal:condition="not: hiddenFiles">
	        <p> none</p> 
	        </metal:block>
	        <metal:block tal:condition="hiddenFiles">
	         <table id="sortable4"
	             class="listing"
	             summary="Content listing"
	             cellpadding="0" cellspacing="0">
	             <thead>
	                <tr>
	                   <th>Title</th>
	                </tr>
	             </thead>
	           <tbody>
		           <metal:block tal:repeat="item hiddenFiles">
	                  <tr>
	                    <td i18n:translate="" tal:content="python:item">
	                      itemName
	                    </td>
	                  </tr>
	              </metal:block>
	             </tbody>
	            </table>
	           </metal:block>
	        </fieldset>

        </fieldset>
        
        <fieldset tal:condition="python:show.find('LegalContent') >= 0">
        <legend>Legal Content:</legend>
 
        <b>files with legal Plone ID's</b><br>
        
        <metal:block tal:condition="not: legalFiles">
        <p> none</p> 
        </metal:block>
        <metal:block tal:condition="legalFiles">
         <br>
         <table id="sortable5"
             class="listing"
             summary="Content listing"
             cellpadding="0" cellspacing="0">
             <thead>
                <tr>
                   <th>Title</th>
                </tr>
             </thead>
           <tbody>
	           <metal:block tal:repeat="item legalFiles">
                  <tr>
                    <td i18n:translate="" tal:content="python:item">
                      itemName
                    </td>
                  </tr>
              </metal:block>
             </tbody>
           </table>
        </metal:block>
        </fieldset>
     </div>
  </div>
</body>
</html>
