<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      i18n:domain="pfm">
<body>
<div metal:define-macro="portlet"
       i18n:domain="pfm"
       tal:omit-tag="" >
    <div class="portlet" 
         id="portlet-formmailer"
         tal:define="pfm python:here.pfmbox;
	             translatable python:hasattr(portal,'portal_languages') and portal.portal_languages.isTranslatable(pfm);
                     pfm python:translatable and pfm.getTranslation() or pfm;
                     form python:pfm.form">
        <div class="padding">
            <h5 tal:content="pfm/title_or_id">Title or Id</h5>
            <div class="portletBody"
                 tal:define="title python: test(form.title, form.title, 'unknown');
                             method python:form.method; 
                             enc python:form.enctype;
                             fname string:${title}_form; 
                             tid template/id;
                             tabindex python:Iterator()">
                <div class="portletContent odd">
                <form tal:define="groups form/get_groups"
                      tal:attributes="action pfm/id;
                                      id form/name;
                                      method form/method;
                                      enctype form/enctype">
    
                    <tal:repeat tal:repeat="group groups" >
                    <fieldset tal:omit-tag="python:group=='Default'">
     
                        <legend tal:content="group" 
                                tal:condition="python:group!='Default'"
                                i18n:translate="">
                            Legend
                        </legend>
                            
                        <tal:repeat define="fields python:form.get_fields_in_group(group)"
                                    repeat="field fields">
                    
                            <div class="field"
                                 tal:condition="not:field/hidden"
                                 tal:define="field_id field/id;">
                                           
                                <label tal:content="field/title"
                                       i18n:translate="">Label</label>
                    
                                <span tal:condition="field/is_required"
                                      class="fieldRequired"
                                      title="Required"
				      i18n:domain="plone"
                                      i18n:attributes="title"
                                      i18n:translate="label_required">(Required)</span>
                    
                                <div class="formHelp"
                                     tal:define="desc python:field['description']"
                                     tal:content="desc"
                                     i18n:translate="">Help</div>
                                                        
                                <div tal:define="initvalue python:test(field.id in ['email','fullname'],member.getProperty(field.id, ''),''); 
				                 input python:field.render(REQUEST=request, value = initvalue )"
                                     tal:replace="structure input"
                                     tal:attributes="tabindex tabindex/next;">
                                </div>
                    
                            </div>
    
                            <div tal:condition="field/hidden"
                                 tal:define="input python:field.render(REQUEST=request)"
                                 tal:replace="structure input">
                            </div>
                            
                        </tal:repeat>
                    </fieldset>
                    </tal:repeat>
    
                    <div class="formControls">
                        <input tal:repeat="button python:pfm.getButtons()"                           
                               tal:attributes="value python:button[0] or 'submit';
                                               name  python:button[1] or button[0];
                                               type  python:button[2] or 'submit';
                                               class python:button[3] or 'context';
                                               tabindex tabindex/next;"
                               class="context"/> 
                    </div>
                
                    <input type="hidden" name="form.submitted" value="1" />
                    <input type="hidden" name="uf_formid" tal:attributes="value form/id" />
                
                </form>
               </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
