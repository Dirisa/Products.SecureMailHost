<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      i18n:domain="plonecollectorng"
      metal:use-macro="here/main_template/macros/master">
  <body>

    <metal:block metal:fill-slot="head_slot">
	  <link rel="Stylesheet" type="text/css" tal:attributes="href string:$portal_url/pcng_styles.css" />
    </metal:block>

    <div metal:fill-slot="main"
         tal:define="days python:request.get('days', 14)">

      <metal:block tal:define="action string: Recent activity">
        <span metal:use-macro="here/pcng_macros/macros/collector_headline" />
      </metal:block>

      <div style="text-align: right" >
        <form method="get" action="pcng_issue_view_recent">
        <span i18n:translate="issues_last_n_days">Issues changed during the last </span>
          <select name="days:int">
            <option tal:repeat="day python: range(1, 100)" 
                    tal:attributes="value day; SELECTED python: day == request.get('days', 0)"
                    tal:content="day" />
          </select>
          <span i18n:translate="days">days</span>
          <input type="submit" class="standalone" value="Refresh" i18n:attributes="value" />                
        </form>
      </div>

      <ul tal:define="rows python: here.pcng_catalog(last_action = {'query' : DateTime()-days, 'range': 'min'}, 
                                                     sort_on='last_action', 
                                                     sort_order='reverse')">
        <tal:loop tal:repeat="row rows">
          <li>      
            <span tal:content="python: here.toLocalizedTime(DateTime(row.last_action), long_format=1)" />  
            <a tal:attributes="href string:${row/getURL}/pcng_issue_view" 
               tal:content="python: row.getObject().title_or_id()"/>
          </li>
        </tal:loop>
      </ul>

    </div>
  </body>
</html>
