<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      i18n:domain="plonecollectorng"
      metal:use-macro="here/main_template/macros/master">
  <body>

    <div metal:fill-slot="css_slot">
      <metal:define metal:use-macro="here/pcng_css/macros/stylesheet" />
    </div>

    <div metal:fill-slot="main">
      <h1 tal:content="string: ${here/title_or_id} (${here/status})" />

      <a tal:condition="python: request.get('mode', 'simple') == 'simple'" href="?mode=full">Full view</a>
      <a tal:condition="python: request.get('mode', 'simple') != 'simple'"  href="?mode=simple">Simple view</a>

      <div class="group" tal:repeat="fieldset python: ('issuedata',)">
        <span class="legend" tal:content="fieldset" />
        <metal:block tal:repeat="fieldname python: ('title', 'description', 'solution')" >
          <div class="row" tal:condition="python: getattr(here, fieldname)" >
	        <span metal:use-macro="python: here.widget(fieldname, mode='view', use_label=1)"/>
          </div>
        </metal:block> 
        
        <metal:block tal:repeat="field python: here.schema_getSchema('issuedata').fields()">
          <metal:block tal:condition="python: field.getName() not in ('title', 'description', 'solution')">
          <div metal:use-macro="here/issue_macros/macros/field_shortview" />
        </metal:block>
        </metal:block>

        <span class="schemata_label" i18n:translate="status">Status: </span><span class="field" tal:content="python: here.pcng_format_status(here.status())" />&nbsp;&nbsp;
        <span class="schemata_label" i18n:translate="assigned_to">Assigned to: </span><span class="field" tal:content="python: ', '.join(here.assigned_to(sorted=1))" />
      </div>


      <metal:block tal:condition="python: request.get('mode', 'simple') == 'full'" >

        <metal:block tal:repeat="schemata_name python: here.schema_getNames()">
          <metal:block tal:define="schemata python:here.schema_getSchema(schemata_name)">
            <metal:block tal:condition="python: schemata_name not in ('default', 'issuedata') "> 
              <div metal:use-macro="here/issue_macros/macros/view_schemata" />
            </metal:block>
          </metal:block>
        </metal:block>

        <div tal:define="uploads here/objectValues" >
          <div class="group" tal:condition="uploads">
            <span class="legend" i18n:translate="uploads">Uploads</span>
              <metal:block tal:repeat="item uploads">
                <a tal:attributes="href item/absolute_url" tal:content="item/getId"/>
              </metal:block>
          </div>
        </div>

      </metal:block>


      <div class="group"><span class="legend" i18n:translate="transcript">Transcript</span>
        <div metal:use-macro="here/pcng_macros/macros/transcript_plain" /> 
      </div>

      <metal:block tal:condition="python: request.get('mode', 'simple') == 'full'" >

        <metal:block tal:repeat="image python: here.objectValues('Portal Image')">
          <img tal:attributes="src image/absolute_url">
        </metal:block>

        <div metal:use-macro="here/issue_macros/macros/watchlist" /> 

        <div metal:use-macro="here/issue_macros/macros/issue_references" /> 

      </metal:block>

    </div>
  </body>
</html>
