
<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plonecollectorng">

<body>
  <metal:block metal:fill-slot="head_slot">
    <link rel="Stylesheet" type="text/css" tal:attributes="href string:$portal_url/pcng_styles.css" />
  </metal:block>

  <div metal:fill-slot="main">

    <metal:block tal:define="action string: Search form editor">
      <span metal:use-macro="here/pcng_macros/macros/collector_headline" />
    </metal:block>

    <form action="xx" method="GET" name="search_form">

      <div>
        <tal:loop tal:repeat="item here/getIndexes">
          <div style="float: left; margin: 5pt">
            <span class="label" i18n:translate="" tal:content="python: item[0]" />
            <br>
            <tal:if tal:condition="python: item[1] in ('FieldIndex','KeywordIndex')">
              <select multiple size="5" style="text-align: center"
                      tal:attributes="name python: '%s:%s' % (item[0], here.pcng_type_indexed_values(item[0]))">
                <tal:loop tal:repeat="entry python: here.pcng_uniquevalsFor(item[0])" >
                  <option tal:attributes="value entry;
                                          selected python: request.get(item[0],'')==entry" 
                         tal:content="entry" />
                </tal:loop>
              </select>
            </tal:if>

            <tal:if tal:condition="python: item[1].find('TextIndex') > -1">
              <input type="text" tal:attributes="name python: item[0]" value="" size="30">
            </tal:if>
          </div>
        </tal:loop>
        <div style="float: right"></div>
      </div>
      <p>

      <div>
        <span class="label" i18n:translate="fulltextsearch">Fulltext search</span>
        <br/>
        <input type="text" name="SearchableText" value="" size="30" tal:attributes="value request/SearchableText|nothing">
      </div>

      <div>
        <span class="label" align="left" i18n:translate="sorting">Sorting</span>

        <div>
          <select name="sort_on" size="1">
            <option i18n:translate=""
                    tal:repeat="item python: (
                          ('getId','Issue'),
                          ('creation_date','Date'),
                          ('progress_deadline','Deadline'),
                          ('Creator','Submitter'),
                          ('progress','Progress'),
                          ('classification','Classification'),
                          ('status','Status'),
                          ('Title','Title') ,
                          ('topic','Topic'),
                          ('importance','Importance')
                          )"
                     tal:attributes="value python: item[0];
                                     selected python: request.get('sort_on', 'getId') == item[0]"
                     tal:content="python: item[1]" />
          </select> 

          <select name="sort_direction" size="1">
            <option i18n:translate=""
                    tal:repeat="item python: (
                          ('desc','Desc'),
                          ('asc','Asc'),
                          )"
                     tal:attributes="value python: item[0];
                                     selected python: request.get('sort_direction', 'desc') == item[0]"
                     tal:content="python: item[1]" />
          </select> 
        </div>
            
        <span class="label" i18n:translate="hits_per_page">Hits per page</span>

        <div>
          <select name="batchsize:int" size="1">
            <option i18n:translate=""
                    tal:repeat="item python: (
                          (10,10),
                          (25,25),
                          (50,50),
                          (100,100),
                          (250,250),
                          (500,500)
                          )"
                     tal:attributes="value python: item[0];
                                     selected python: request.get('batchsize', 10) == item[0]"
                     tal:content="python: item[1]" />
          </select> 
        </div>

      <div>
        <input type="submit" value="Search" i18n:attributes="value" class="standalone">
      </div>
      
      </div>
    </form>

  </div>
</body>
</html>
