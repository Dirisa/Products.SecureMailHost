<html xmlns="http://www.w3.org/1999/xhtml"
      xml:lang="en-US"
      lang="en-US"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      i18n:domain="plone">

<!-- ***********************************************************************************

Hijacked from plip18, thanks to Phil and others.

Ce que j'ai modifi'checkbox'" en remplapartout les "folder_contents" par "results" pour standardiser. 

********************************************************************************* -->

<body>

<div metal:define-macro="tabular">
  
  <!-- Navigation -->
  <div metal:use-macro="here/batch_macros/macros/navigation" />
  <table id="sortable"
         class="listing"
         summary="Content listing"
         cellpadding="0" cellspacing="0">

  <thead>

  <metal:block tal:condition="folder_contents|not:standalone|nothing">
    <tr>
      <th class="nosort">
        <input class="noborder"
               type="checkbox"
               src="select_all_icon.gif"
               name="selectButton"
               title="Select all items"
               onClick="toggleSelect(this);"
               tal:attributes="src string:$portal_url/select_all_icon.gif"
               alt="Select all items"
               i18n:attributes="title alt" />
      </th>
      
      <th tal:attributes="class python:nosortclass"
      >&nbsp;<tal:title i18n:translate="listing_username"
      >Username</tal:title>&nbsp;</th>
                        
      <th tal:attributes="class python:nosortclass"
      >&nbsp;<tal:fullname i18n:translate="listingheader_fullname"
      >Fullname</tal:fullname>&nbsp;</th>
                        
      <th tal:attributes="class python:nosortclass"
      >&nbsp;<tal:email i18n:translate="listingheader_email"
      >Email</tal:email>&nbsp;</th>
                        
      <th tal:attributes="class python:nosortclass"
      >&nbsp;<tal:last_login i18n:translate="listingheader_last_login"
      >Last Login</tal:last_login>&nbsp;</th>

      <th tal:attributes="class python:nosortclass"
      >&nbsp;<tal:state i18n:translate="listingheader_state"
      >Status</tal:state>&nbsp;</th>
                        
      <th class="nosort" 
          tal:condition="python:isOrderable and canModifyFolderContent"
      >&nbsp;<tal:order i18n:translate="listingheader_order"
      >Order</tal:order>&nbsp;</th>
    </tr>
  </metal:block>
  </thead>

  <metal:block tal:condition="results|not:standalone|nothing">
    <tbody tal:define="getRelativeContentURL nocall:utool/getRelativeContentURL">
      <metal:block tal:repeat="item batch">
        <tr tal:define="item python:hasattr(item, 'getObject') and item.getObject() or item;
                        oddrow repeat/item/odd;
                        item_url item/absolute_url;
                        item_id item/getId;
                        item_title_or_id item/title_or_id;
                        item_typeinfo item/getTypeInfo;
                        arrowUp portal/arrowUp.gif;
                        arrowDown portal/arrowDown.gif;"
            tal:attributes="class python:test(oddrow, 'even', 'odd')" >

           <td>
             <input type="checkbox" class="noborder" name="paths:list" id="#"
                    value="#"
                    tal:attributes="value python:getRelativeContentURL(item);
                                    id python: 'cb_'+item.getId();
                                    checked request/paths_checked|nothing;
                                    tabindex tabindex/next|nothing; alt string:Select $item_title_or_id;
                                    title string:Select $item_title_or_id"/>
            </td>

            <td tal:define="action python:item_typeinfo.immediate_view;
                            url python:test(item_typeinfo.getId() in use_folder_contents,
                                            item_url+'/folder_contents',
                                            item_url+'/'+action);">

              <a href="#" tal:attributes="href url; title item/Description;">

                <img tal:define="icon python:item.getIcon(1); iconObject python:getattr(here,icon)"
                     tal:attributes="src string:$portal_url/$icon; 
                                     alt iconObject/title_or_id;
                                     title item_typeinfo/Title"
                  />&nbsp;<span tal:replace="item_id">Username</span>
              </a>
            </td>

            <td>
		<span tal:replace="item/getFullname"> Fullname </span>
            </td>
            <td>
		<span tal:replace="item/getEmail"> Email </span>
            </td>

            <td>
		<tal:last_login replace="item/getLast_login"> DateTime </tal:last_login>
            </td>

            <td class="private"
                tal:define="review_state python:getInfoFor(item, 'review_state', '')"
                tal:content="structure python:test(review_state, review_state, '&nbsp;')"
                tal:attributes="class python:test(review_state, 'state-'+review_state, 'state-private')"
                i18n:translate="">&nbsp;
            </td>
            <td tal:condition="python:isOrderable and canModifyFolderContent">
              <a href=""
                 title="Move item up"
                 i18n:attributes="title"
                 tal:attributes="href string:$here_url/folder_position?position=up&amp;id=$item_id"
               ><img tal:replace="structure arrowUp" /></a>
               &nbsp;
               <a href=""
                  title="Move item down"
                  i18n:attributes="title"
                  tal:attributes="href string:$here_url/folder_position?position=down&amp;id=$item_id"
               ><img tal:replace="structure arrowDown" /></a>
             </td>
           </tr>
         </metal:block>
       </tbody>
     </metal:block>
  </table>
  <!-- Navigation -->
  <div metal:use-macro="here/batch_macros/macros/navigation" />
  <tal:block tal:define="forbidden_action_ids python:['copy', 'cut', 'paste'];
                         is_folder_content python:request.URL.find('folder_contents')">      
    <tal:buttons tal:repeat="button actions/folder_buttons|nothing">
      <tal:block tal:define="button_id python:button['id'];"
                 tal:condition="python:button_id not in forbidden_action_ids or is_folder_content != -1">
      <input class="context"
             type="submit"
             name=""
             value=""
             tabindex=""
             tal:condition="python:results or (here.cb_dataValid and button_id == 'paste')"
             i18n:attributes="value"
             tal:attributes="value button/name;
                             name button/url;
                             tabindex tabindex/next;
                             class python:test((button_id == 'paste'), 'standalone', 'context')" />
      </tal:block>
    </tal:buttons>
  </tal:block>
     
</div>

</body>
</html>
