<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="here/main_template/macros/master">

  <body>

    <metal:block fill-slot="base">
      <tal:block tal:define="dummy python:request.set('disable_border', 1)"
	         tal:replace="nothing">
        Disable the tabs
      </tal:block>    
    </metal:block>


    <div metal:fill-slot="main"
         tal:define="images python:here.contentValues(spec='Photo');
                     albums python:here.contentValues(spec='Photo Album');
                     Batch python:modules['ZTUtils'].Batch;
                     b_start python:request.get('b_start', 0);
                     batch python:Batch(images, 10, int(b_start), orphan=1);">
      
      <script language="javascript">
        <!--
        var newWin;
	
        function centeredWindow(url, winname) {
	w = screen.width - (screen.width * 0.25)
	h = screen.height - (screen.height * 0.25)
	windowLeft = (screen.width - w)/2;
	windowTop = (screen.height - h)/2;
	settings = '"toolbar=no,directories=no,menubar=no,scrollbars=yes,resizable=yes,status=no,width='+w+',height='+h+',left='+windowLeft+',top='+windowTop+'"';
	closeWindow();
	newWin = window.open(url, winname, settings);
	newWin.focus();
        }
	
        function closeWindow() {
	if (newWin && !newWin.closed) {
	newWin.close();
	}
        }
	-->
      </script>

      <h1 tal:content="here/title_or_id">
	Title or id
      </h1>

      <table style="width: 100%;">
	<tr>
	  <td>
	    <div class="listingBar">
	      <table style="width: 100%">
		<tr>
		  <td style="width: 33%">
		    <span class="previous" tal:define="p batch/previous | nothing" tal:condition="p"> 
		      <a href="#" tal:attributes="href string:?b_start=${p/first}"> &laquo; previous photos</a>
		    </span>
		  </td>
		  <td style="width: 33%; text-align: center;">
		    <input type="button" 
			   value="Start slideshow" 
			   class="context"
			   onClick="javascript:centeredWindow('photoalbum_slideshow'); return false;"/>
		  </td>
		  <td style="width: 33%">
		    <span class="next" tal:define="n batch/next | nothing" tal:condition="n"> 
		      <a href="#" tal:attributes="href string:?b_start=${batch/end}">next photos &raquo;</a>
		    </span>
		  </td>
		</tr>
	      </table>
	    </div>
	  </td>
	</tr>
	<tr>
	  <td>
	    <tal:block tal:condition="batch"
     	               tal:repeat="image batch">
	      <span class="card" style="background: white; border-color: white; height: 130px; width:130px;">
		<a tal:define="id python:int(b_start)+int(repeat['image'].number()-1)" tal:attributes="href string:${here/absolute_url}/photoalbum_photo_view?b_start=$id">
		  <img tal:replace="structure python:image.tag(size='thumbnail')" />
		</a>
	      </span>
	    </tal:block>
	  </td>
	</tr>
	<tr>
	  <td>
	    <tal:block tal:condition="albums"
	               tal:repeat="album albums">
	      <span class="card" tal:define="images_in_album python:album.contentValues(spec='Photo');
		                             number_of_images python:len(images_in_album)">
		<a tal:condition="images_in_album" tal:attributes="href string:${album/absolute_url}/view">
		  <img tal:replace="structure python:images_in_album[0].tag(size='thumbnail')" />
		</a>
		<br/><span tal:content="structure string:<strong>${album/title_or_id}</strong><br/>$number_of_images photos in album"></span>
	    </span>
	    </tal:block>
	  </td>
	</tr>
      </table>

      <div class="spacer">&nbsp;</div>          
    </div>
    
  </body>

</html>

