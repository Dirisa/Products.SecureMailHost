<metal:div metal:define-macro="results" i18n:domain="plonecollectorng">

  <tal:def tal:define="results here/pcng_search_results; 
                    Batch python: modules['Products.CMFPlone'].Batch;
                    b_size python: request.get('batchsize', member.getProperty('pcng_hits_per_page', 10));
                    b_start python: 0;
                    b_start request/b_start|b_start;
                    have_reportlab here/haveReportlab">

    <div tal:condition="results" tal:define="batch python: Batch(results, b_size, int(b_start), orphan=0)">

      <div metal:use-macro="here/batch_macros/macros/navigation" />

      <metal:block tal:repeat="issue batch">
        <div metal:use-macro="here/issue_macros/macros/issue_shortview" />
      </metal:block>
      <div metal:use-macro="here/batch_macros/macros/navigation" />
    </div>
    <div tal:condition="not: results">
      <span class="label" i18n:translate="no_issues_found">No issues found</span>
    </div>
  </tal:def>
</metal:div>    

<metal:div metal:define-macro="results2" i18n:domain="plonecollectorng">

  <tal:def tal:define="results here/pcng_search_results; 
                    Batch python: modules['Products.CMFPlone'].Batch;
                    b_size python: request.get('batchsize', member.getProperty('pcng_hits_per_page', 10));
                    b_start python: 0;
                    b_start request/b_start|b_start;
                    have_reportlab here/haveReportlab">

    <table class="listing" tal:condition="results" tal:define="batch python: Batch(results, b_size, int(b_start), orphan=0)">

      <tr>
        <th>#</th>
        <th>Description</th>
        <th>State</th>
        <th>Importance</th>
        <th>topic</th>
        <th></th>
        <th>Created</th>
      </tr>

      <tr tal:repeat="issue batch">
        <td>
          <a tal:attributes="href issue/getId"
             tal:content="issue/getId" />
        </td>
        <td>
          <a tal:attributes="href issue/getId"
             tal:content="issue/Title" />
        </td>
        <td> 
          <span tal:attributes="id string:state_${issue/status}" 
                i18n:translate="" tal:content="python: here.pcng_format_status(issue.status)" />
          <tal:if tal:condition="issue/assigned_to|nothing">
             <br/>-><span tal:replace="python: ', '.join(issue.assigned_to)" /> 
          </tal:if>
        </td>
        <td>
          <tal:def tal:define="field python: here.atse_getSchemaById('PloneIssueNG')['importance'];
                               vocab python: field.Vocabulary(here);
                               display python: here.displayValue(vocab, issue.importance)">
              <span tal:content="structure display" />
          </tal:def> 
        </td>
        <td>
          <span tal:replace="issue/topic" /> 
        </td>
        <td>
          <span tal:replace="issue/numberFollowups|nothing" /> /
          <span tal:replace="issue/numberUploads|nothing" /> /
          <span tal:replace="issue/numberReferences|nothing" />
        </td>
        <td>
          <span tal:content="issue/Creator" />
        </td>

      </tr>
    </table>
    <div tal:condition="not: results">
      <span class="label" i18n:translate="no_issues_found">No issues found</span>
    </div>
  </tal:def>
</metal:div>    


  <div id="pcng_issueview_legend">
    <span i18n:translate="submitted_by">Submitted by</span> <span tal:replace="issue/Creator" /> <span i18n:translate="date_on">on</span> <span tal:replace="python: here.toLocalizedTime(issue.created)" /> &bull; 
    <span i18n:translate="last_modified">Last modified:</span> <span tal:replace="python: here.toLocalizedTime(issue.modified)" />
    (<span tal:replace="python: '%.1f' % (DateTime() - issue.modified)" />
    <span i18n:translate="days_ago">days ago</span>)
