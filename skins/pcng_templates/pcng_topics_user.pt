
<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plonecollectorng">

<body>
<metal:block metal:fill-slot="head_slot">
  <link rel="Stylesheet" type="text/css" tal:attributes="href string:$portal_url/pcng_styles.css" />
</metal:block>
<div metal:fill-slot="main">	  

  <metal:block tal:define="action string: Topic-Staff mapping; navig_configuration nothing">
    <span metal:use-macro="here/pcng_macros/macros/collector_headline" />
  </metal:block>


  <table class="listing" 
         tal:define="users python: here.getTrackerUsers(staff_only=1)">
    <tr>
      <th i18n:translate="topic">Topic</th>
      <th i18n:translate="staff_members">Staff members</th>
      <th i18n:translate="action">Action</th>
    </tr>

    <tal:loop tal:repeat="topic python: context.getTopics().getTopics()">
      <tr tal:attributes="class python:test(repeat['topic'].even(), 'even', 'odd')"
          tal:define="users python: here.getTopics().getUsersForTopic(topic)">
  
        <td valign="top"> 
          <span tal:content="topic" />
        </td>
        <td>
          <span tal:replace="python: ', '.join(users)" />
        </td>
        <td tal:define="topic python: context.quote(topic)">
          <a tal:attributes="href string:pcng_topics_user_form?topic=$topic">
            <img src="edit.gif" title="Edit assignment" i18n:attributes="title"/>
          </a>
          <a tal:attributes="href string:pcng_delete_topic?topic=$topic">
            <img src="delete.gif" title="Delete topic" i18n:attributes="title"/>
          </a>
        </td>
      </tr>
    </tal:loop>
  </table>

  <form method="post" action="pcng_add_topic">
    <input type="text" name="topic" value="">
    <input type="submit" class="context" i18n:attributes="value" value="New topic" />
  </form>

    
  <hr>
  <div class="formHelp" i18n:translate="help_topics_users">
  Topics taken from the Archetypes field 'topic' can be assigned to a set of staff members.
  All staff members are automatically assigned to an issue if the submitter/supporter chooses
  to assign an issue to a topic-group. The group of topics is taken from the list of all topics
  except that topics named <em>maintopic/subtopic</em> are considered to belong to the topic
  <em>maintopic</em>.  
  </div>
</div>
</body>
</html>
