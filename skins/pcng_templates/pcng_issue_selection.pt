<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      i18n:domain="plonecollectorng">
<head>
  <title i18n:translate="title_issue_selection">Issue selection</title>
  <link rel="stylesheet" href="plone.css" type="text/css">
  <tal:check tal:define="dummy context/pcng_check_access" />
</head>
<body>
<html>

<div class="ticket_selection">

  <script language="javascript">
  function do_submit(ticket) {
      window.opener.document.myform['reference.ticketnumber:record:string'].value = ticket;
      window.close();
  }
  </script>

  <h1 tal:content="string: Collector: ${here/title_or_id}" />

  <form method="post" action="" name="myform" onSubmit="javascript:do_submit()">
    <ul>
      <li tal:repeat="ticket python: here.pcng_catalog(meta_type='PloneIssueNG', sort_on='created')">
        <a tal:content="python: here.shorten_string('%s: %s' % (ticket.getId, ticket.Title), maxlength=50)" 
           tal:attributes="href python: 'javascript:do_submit(%s)' % ticket.getId" />
      </li>

    </ul>
  </form>
</div>
</body>
</html>

