<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plonecollectorng">

<body>

  <metal:block metal:fill-slot="head_slot">
    <link rel="Stylesheet" type="text/css" tal:attributes="href string:$portal_url/pcng_styles.css" />
  </metal:block>

  <div metal:fill-slot="main">	  

    <metal:block tal:define="action string: Notifications; navig_configuration nothing">
      <span metal:use-macro="here/pcng_macros/macros/collector_headline" />
    </metal:block>

    <br/>    
    <div tal:condition="python: here.notification_policy != 'NoneNotificationPolicy'">
      <form action="set_notification_emails" method="post">
        <div class="row" 
             tal:define="states here/issue_states;
                         stateslen python: len(states)"
             tal:repeat="itemnum python: range((stateslen))">
          <div class="label"> 
            <span i18n:translate="" 
                  tal:content="python: states[itemnum]" />
          </div>
          <div class="field"> 
              <textarea rows="2" cols="45" 
                        tal:attributes="name python: 'notifications.%s:record:lines' % states[itemnum]"
                        tal:content="python: '\n'.join(here.getNotificationsForState(states[itemnum]))"
              ></textarea>
          </div>
        </div>
 
        <div class="row">
          <div class="label">&nbsp;</div>
          <div class="field">
            <input type="submit" class="context" value="Save"
                   i18n:attributes="value"  class="standalone"/>
            <input type="reset" class="context" value="Reset"
                   i18n:attributes="value"  class="standalone"/>
          </div>
        </div> <!-- End row -->
        <div>
        <hr>
        <span i18n:translate="help_notifications">
          This forms allows you to specify additional email addresses for each workflow
          state that will be notified in case of a workflow state change. Email addresses
          must be put in different rows inside the textarea.
        </span>
        </div>
     </form>
   </div>

   <div tal:condition="python: here.notification_policy == 'NoneNotificationPolicy'">
     <span i18n:translate="notification_mode_disabled">Notification mode is disabled</span>.
   </div>
  </div>
</body>
</html>
